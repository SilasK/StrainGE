#!/usr/bin/env python
import sys
import argparse
import kmertools
import numpy as np
import matplotlib.pyplot as plt

parser = argparse.ArgumentParser()
parser.add_argument('kmerfiles', nargs='+',
                    help='Input kmer files (npz with counts)')
parser.add_argument("-s", "--spectrum", help="File to ouput kmer spectrum graph (.png best)")
parser.add_argument("-m", "--max", type=int, help="Max frequence for kmer spectrum plot")
args = parser.parse_args()

kset = kmertools.KmerSet()


for kmerfile in args.kmerfiles:
    kset.load(kmerfile)
    spectrum = kset.spectrum()
    plt.semilogy(spectrum[0], spectrum[1], label=kmerfile.split('.')[0])

plt.xlabel("Kmer Frequency")
plt.ylabel("Number of Kmers")
plt.legend()

if args.max:
    plt.xlim(0, args.max)

if args.spectrum:
    plt.savefig(args.spectrum)
else:
    plt.show()

